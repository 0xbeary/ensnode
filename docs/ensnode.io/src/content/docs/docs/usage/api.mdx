---
title: Using ENSNode's API
sidebar:
  label: ENSNode's API
  order: 3
---

import { LinkCard } from "@astrojs/starlight/components";

## Realtime Indexing Status Monitoring

You can track ENSNode's realtime indexing status using the `GET /amirealtime` endpoint.

HTTP clients can define their acceptable indexing lag using the `maxAllowedIndexingLag` query parameter. For example, if you want to check whether ENSNode is no more than 10 minutes behind the chain's latest block, you would set the maximum allowed lag to 10 minutes.

To make this request, send the following HTTP request to ENSNode: `GET /amirealtime?maxAllowedIndexingLag=600`, where `600` represents the time span in seconds (10 minutes = 600 seconds).

**Response Handling:**

- **Status Code 503**: The requested realtime indexing gap has not been achieved
- **Status Code 200**: The indexing lag is within acceptable limits

The response data is returned regardless of the status code. Here's an example response:

```json
{
  "currentRealtimeIndexingLag": 42608279,
  "maxAllowedIndexingLag": 600,
  "oldestLastIndexedBlockTimestamp": 1709373060
}
```

## GraphQL

ENSNode exposes two GraphQL endpoints:

- `/ponder` — uses a Ponder-native GraphQL schema
- `/subgraph` — uses a subgraph-compatible GraphQL schema

:::note[Subgraph API Compatibility Reference]
For details on subgraph compatibility, see the Subgraph Compatibility documentation.

<LinkCard
  href="/docs/reference/subgraph-compatibility"
  title="Subgraph Compatibility"
/>
:::

ENSNode also exposes Ponder's `@ponder/client` API endpoint at `/sql/*`.

:::note[Note on `@ponder/client`]
The `@ponder/client` package provides an SQL client for querying a Ponder app over HTTP, with end-to-end type inference and live updates. It's an alternative to the GraphQL API, suitable for client applications. [Learn about how this is secured](https://ponder.sh/docs/query/client#security).

<LinkCard
  href="https://ponder.sh/docs/query/client"
  title="@ponder/client Documentation"
  target="_blank"
/>
:::

## GraphiQL Playground

To observe the full schema and play with each GraphQL API, use the provided GraphiQL Playground for each.

<LinkCard
  href="https://api.alpha.ensnode.io/ponder"
  title="Ponder-native GraphiQL Playground"
/>

<LinkCard
  href="https://api.alpha.ensnode.io/subgraph"
  title="Subgraph-compatible GraphiQL Playground"
/>

## GraphQL Examples

Fetch data about the three most recently-created domains.

### Ponder-native API (`/ponder`)

```gql
{
  domains(orderBy: "createdAt", orderDirection: "desc", limit: 3) {
    items {
      name
      expiryDate
    }
  }
}
```

```json
{
  "data": {
    "domains": {
      "items": [
        {
          "name": "ensanguo.eth",
          "expiryDate": "1758170255"
        },
        {
          "name": "fiffer.eth",
          "expiryDate": "2041994243"
        },
        {
          "name": "rifaisicilia.eth",
          "expiryDate": "1758170039"
        }
      ]
    }
  }
}
```

### Subgraph-compatible API (`/subgraph`)

```gql
{
  domains(orderBy: createdAt, orderDirection: desc, first: 3) {
    name
    expiryDate
  }
}
```

```json
{
  "data": {
    "domains": [
      {
        "name": "ensanguo.eth",
        "expiryDate": "1758170255"
      },
      {
        "name": "fiffer.eth",
        "expiryDate": "2041994243"
      },
      {
        "name": "rifaisicilia.eth",
        "expiryDate": "1758170039"
      }
    ]
  }
}
```
